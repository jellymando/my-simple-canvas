(()=>{"use strict";var t={590:t=>{var e,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var i=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(n,r){function i(n){t.removeListener(e,o),r(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}d(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&d(t,"error",e,n)}(t,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function u(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function a(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function c(t,e,n,r){var i,o,s,c;if(u(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=a(t))>0&&s.length>i&&!s.warned){s.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=t,f.type=e,f.count=s.length,c=f,console&&console.warn&&console.warn(c)}return t}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):l(i,i.length)}function v(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function l(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function d(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){r.once&&t.removeEventListener(e,i),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return a(this)},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var u=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw u.context=s,u}var a=o[t];if(void 0===a)return!1;if("function"==typeof a)r(a,this,e);else{var c=a.length,f=l(a,c);for(n=0;n<c;++n)r(f[n],this,e)}return!0},o.prototype.addListener=function(t,e){return c(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return c(this,t,e,!0)},o.prototype.once=function(t,e){return u(e),this.on(t,h(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return u(e),this.prependListener(t,h(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,r,i,o,s;if(u(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},o.prototype.listeners=function(t){return p(this,t,!0)},o.prototype.rawListeners=function(t){return p(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):v.call(t,e)},o.prototype.listenerCount=v,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},392:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0;var i=r(n(590)),o=n(344),s=function(){function t(t){var e=t.color,n=t.thickness;this.canvas=null,this.ctx=null,this.drawOn=o.getDrawOn(),this.isDrawing=!1,this.strokeColor=e||"red",this.thickness=n||3,this.positions=[],this.figures=o.getFigures(),this.emitter=new i.default,this.removeDrawEvent=function(){}}return t.prototype.setTarget=function(t){this.canvas=t,this.ctx=t.getContext("2d"),this.addDrawEvent(),this.drawOn&&this.figures.length>0&&this.redraw()},t.prototype.on=function(t,e){return this.emitter.on(t,e)},t.prototype.add=function(t,e){var n=this;if(this.canvas)return this.canvas.addEventListener(t,e),function(){n.canvas.removeEventListener(t,e)}},t.prototype.drawStart=function(){this.isDrawing=!0,this.setOptions({color:this.strokeColor,thickness:this.thickness})},t.prototype.draw=function(t,e){if(void 0===e&&(e=!1),this.ctx){var n=t.x,r=t.y;this.isDrawing?(this.ctx.lineTo(n,r),this.ctx.stroke()):this.ctx.beginPath(),e||(this.positions.push(t),this.emitter.emit("draw",t))}},t.prototype.drawEnd=function(){this.isDrawing=!1,this.ctx.beginPath(),this.setFigures(),this.emitter.emit("drawEnd")},t.prototype.redraw=function(){for(var t=this,e=0,n=this.figures;e<n.length;e++){var r=n[e];this.setOptions(r.painterOption),r.positions.forEach((function(e){t.draw(e,!0)})),this.ctx.beginPath()}},t.prototype.setOptions=function(t){var e=t.color,n=t.thickness;this.ctx&&(this.ctx.strokeStyle=e,this.ctx.lineWidth=n)},t.prototype.getFigures=function(){this.figures=o.getFigures()},t.prototype.setFigures=function(){this.figures.push({painterOption:{color:this.strokeColor,thickness:this.thickness},positions:this.positions}),o.storage.set("figures",this.figures),this.positions=[],this.emitter.emit("figures")},t.prototype.addDrawEvent=function(){var t=this;if(this.canvas){var e=[this.add("mousedown",(function(){return t.drawStart()})),this.add("mousemove",(function(e){return function(e){var n={x:e.clientX,y:e.clientY};t.draw(n)}(e)})),this.add("mouseup",(function(){return t.drawEnd()})),this.add("mouseleave",(function(){return t.drawEnd()})),this.add("touchstart",(function(){return t.drawStart()})),this.add("touchmove",(function(e){return function(e){e.target===t.canvas&&e.preventDefault();var n=t.canvas.getBoundingClientRect(),r={x:e.touches[0].clientX-n.left,y:e.touches[0].clientY-n.top};t.draw(r)}(e)})),this.add("touchend",(function(){return t.drawEnd()}))];this.removeDrawEvent=function(){return e.forEach((function(t){return t()}))}}},t.prototype.clear=function(){this.ctx.clearRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight)},t.prototype.destroy=function(){this.removeDrawEvent(),this.emitter.removeAllListeners(),o.storage.remove("figures")},t}();e.default=s},607:function(t,e,n){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=!0,e.Painter=void 0;var i=r(n(392));e.Painter=i.default,e.default=i.default;var o=document.getElementById("canvas");new i.default({color:"red",thickness:3}).setTarget(o)},344:(t,e)=>{e.__esModule=!0,e.getFigures=e.getDrawOn=e.storage=void 0;var n="painter",r=function(){function t(){this._items=JSON.parse(sessionStorage.getItem(n)||JSON.stringify({log:[]}))}return t.prototype.get=function(t){return this._items[t]},t.prototype.all=function(){return this._items},t.prototype.set=function(t,e){this._items[t]=e,this._save()},t.prototype.remove=function(t){delete this._items[t],this._save()},t.prototype._save=function(){sessionStorage.setItem(n,JSON.stringify(this._items))},t.prototype.clear=function(){this._items={log:[]},this._save()},t}();e.storage=new r;e.getDrawOn=function(){return e.storage.get("drawOn")||!1};e.getFigures=function(){return e.storage.get("figures")||[]}}},e={};(function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports})(607)})();